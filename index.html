<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Drag & Drop für iPad</title>
<style>
body {
    margin:0; padding:15px;
    display:flex; gap:15px;
    font-family:Arial,sans-serif;
    height:100vh; box-sizing:border-box;
}
.side {
    width:15%;
    display:flex;
    flex-direction:column;
    gap:20px;
    justify-content:center;
    align-items:center;
}
.side img {
    width:100%;
    max-width:180px;
    border-radius:10px;
    border:2px solid #aaa;
    background:white;
    cursor:grab;
}
.droparea {
    width:70%;
    height:100%;
    background:white;
    border:3px dashed #777;
    border-radius:15px;
    position:relative;
    overflow:hidden;
}
.drop-img {
    width:100px; height:100px;
    object-fit:cover;
    border-radius:10px;
    position:absolute;
    touch-action:none;
    cursor:grab;
}
</style>
</head>
<body>

<div class="side">
    <img src="bilder/paket_1.png">
    <img src="bilder/paket_2.png">
    <img src="bilder/paket_3.png">
</div>

<div class="droparea" id="droparea"></div>

<div class="side">
    <img src="bilder/schleife_1.png">
    <img src="bilder/schleife_2.png">
    <img src="bilder/schleife_3.png">
</div>

<script>
const droparea = document.getElementById('droparea');

// Hilfsfunktion: macht ein Bild draggable auf Desktop & Touch
function makeDraggable(img) {
    let dragging = false;
    let offsetX=0, offsetY=0;

    function startDrag(clientX, clientY) {
        dragging = true;
        const rect = img.getBoundingClientRect();
        offsetX = clientX - rect.left;
        offsetY = clientY - rect.top;
    }

    function moveDrag(clientX, clientY) {
        if(!dragging) return;
        const rect = droparea.getBoundingClientRect();
        let x = clientX - rect.left - offsetX;
        let y = clientY - rect.top - offsetY;
        // Grenzen innerhalb Droparea
        x = Math.max(0, Math.min(x, droparea.clientWidth - img.clientWidth));
        y = Math.max(0, Math.min(y, droparea.clientHeight - img.clientHeight));
        img.style.left = x + 'px';
        img.style.top = y + 'px';
    }

    function endDrag() { dragging = false; }

    // Desktop
    img.addEventListener('mousedown', e=>{
        startDrag(e.clientX, e.clientY);
        e.preventDefault();
    });
    document.addEventListener('mousemove', e=>moveDrag(e.clientX, e.clientY));
    document.addEventListener('mouseup', endDrag);

    // Touch
    img.addEventListener('touchstart', e=>{
        const touch = e.touches[0];
        startDrag(touch.clientX, touch.clientY);
        e.preventDefault();
    }, {passive:false});
    document.addEventListener('touchmove', e=>{
        if(!dragging) return;
        const touch = e.touches[0];
        moveDrag(touch.clientX, touch.clientY);
        e.preventDefault();
    }, {passive:false});
    document.addEventListener('touchend', endDrag);

    // Doppeltap / dblclick zum Entfernen
    let lastTap=0;
    img.addEventListener('touchend', e=>{
        const now = Date.now();
        if(now - lastTap < 300) img.remove();
        lastTap = now;
    });
    img.addEventListener('dblclick', ()=>img.remove());
}

// Alle Bilder in den Seiten klickbar für Drag & Drop
document.querySelectorAll('.side img').forEach(img=>{
    img.addEventListener('mousedown', startAdd);
    img.addEventListener('touchstart', startAdd, {passive:false});
});

function startAdd(e){
    const isTouch = e.type.startsWith('touch');
    const clientX = isTouch ? e.touches[0].clientX : e.clientX;
    const clientY = isTouch ? e.touches[0].clientY : e.clientY;
    const newImg = this.cloneNode(true);
    newImg.classList.add('drop-img');
    newImg.style.left = (clientX - 50) + 'px';
    newImg.style.top = (clientY - 50) + 'px';
    droparea.appendChild(newImg);
    makeDraggable(newImg);
    e.preventDefault();
}
</script>

</body>
</html>
