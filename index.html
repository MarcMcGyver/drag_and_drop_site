<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Drag & Drop iPad & Responsive</title>
<style>
body {
    margin:0; padding:15px;
    display:flex; gap:15px;
    font-family:Arial,sans-serif;
    height:100vh; box-sizing:border-box;
}
.side {
    width:15%;
    display:flex;
    flex-direction:column;
    gap:20px;
    justify-content:center;
    align-items:center;
}
.side img {
    width:100%;
    max-width:180px;
    border-radius:10px;
    border:2px solid #aaa;
    background:white;
    cursor:grab;
}
.droparea {
    flex:1;
    background:white;
    border:3px dashed #777;
    border-radius:15px;
    position:relative; /* wichtig für absolute Positionierung der Kinder */
    overflow:hidden;
}
.drop-img {
    width:120px;
    object-fit:cover;
    border-radius:10px;
    position:absolute;
    cursor:grab;
}
@media (max-width:768px){
    body {flex-direction:column;}
    .side {width:100%; flex-direction:row; justify-content:center;}
    .droparea {width:100%; height:50vh;}
}
</style>
</head>
<body>

<div class="side">
    <img src="bilder/paket_1.png">
    <img src="bilder/paket_2.png">
    <img src="bilder/paket_3.png">
</div>

<div class="droparea" id="droparea"></div>

<div class="side">
    <img src="bilder/schleife_1.png">
    <img src="bilder/schleife_2.png">
    <img src="bilder/schleife_3.png">
</div>

<script>
const droparea = document.getElementById('droparea');

// Funktion zum Draggen & Löschen
function makeDraggable(img){
    let dragging=false, offsetX=0, offsetY=0;

    function startDrag(x,y){
        dragging=true;
        const rect=img.getBoundingClientRect();
        offsetX=x - rect.left;
        offsetY=y - rect.top;
    }
    function moveDrag(x,y){
        if(!dragging) return;
        const rect=droparea.getBoundingClientRect();
        let left = x - rect.left - offsetX;
        let top  = y - rect.top - offsetY;
        left = Math.max(0, Math.min(left, droparea.clientWidth - img.clientWidth));
        top  = Math.max(0, Math.min(top, droparea.clientHeight - img.clientHeight));
        img.style.left = left + 'px';
        img.style.top  = top  + 'px';
    }
    function endDrag(){ dragging=false; }

    // Desktop
    img.addEventListener('mousedown', e=>{startDrag(e.clientX,e.clientY); e.preventDefault();});
    document.addEventListener('mousemove', e=>moveDrag(e.clientX,e.clientY));
    document.addEventListener('mouseup', endDrag);

    // Touch
    img.addEventListener('touchstart', e=>{
        const t=e.touches[0];
        startDrag(t.clientX,t.clientY);
        e.preventDefault();
    }, {passive:false});
    document.addEventListener('touchmove', e=>{
        if(!dragging) return;
        const t=e.touches[0];
        moveDrag(t.clientX,t.clientY);
        e.preventDefault();
    }, {passive:false});
    document.addEventListener('touchend', endDrag);

    // Doppeltap / dblclick zum Entfernen
    let lastTap=0;
    img.addEventListener('touchend', ()=>{
        const now=Date.now();
        if(now-lastTap<300) img.remove();
        lastTap=now;
    });
    img.addEventListener('dblclick', ()=>img.remove());
}

// Funktion um neues Bild zu droppen
function addImage(e){
    const isTouch=e.type.startsWith('touch');
    const x = isTouch ? e.touches[0].clientX : e.clientX;
    const y = isTouch ? e.touches[0].clientY : e.clientY;

    const newImg = this.cloneNode(true);
    newImg.classList.add('drop-img');
    newImg.style.position='absolute';

    // Position relativ zur Droparea
    const rect = droparea.getBoundingClientRect();
    let left = x - rect.left - newImg.width/2;
    let top  = y - rect.top - newImg.height/2;

    left = Math.max(0, Math.min(left, droparea.clientWidth - newImg.width));
    top  = Math.max(0, Math.min(top, droparea.clientHeight - newImg.height));

    newImg.style.left = left + 'px';
    newImg.style.top  = top + 'px';

    droparea.appendChild(newImg);
    makeDraggable(newImg);

    e.preventDefault();
}

// Alle Bilder aus beiden Seiten aktivieren
document.querySelectorAll('.side img').forEach(img=>{
    img.addEventListener('mousedown', addImage);
    img.addEventListener('touchstart', addImage, {passive:false});
});
</script>

</body>
</html>
